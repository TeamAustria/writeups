exploit.qvm: exploit.c.asm exploit.asm exploit.stack.asm
	q3vm.git/q3asm/q3asm -o $@ $^

exploit.stack.asm: exploit_stack_gen.py
	python $^ > $@

exploit.c.asm: exploit.c
	q3vm.git/bin/linux/lcc -o $@ $<

clean:
	rm exploit.c.asm exploit.stack.asm exploit.qvm

q3vm-setup:
	@rm -rf q3vm.git
	git clone https://github.com/jnz/q3vm q3vm.git
	cd q3vm.git && git apply ../q3asm.patch
	cd q3vm.git && make